<!DOCTYPE html>
<html lang="zh-cn">

<head>
	<style>
		.chart-container {
			height: 330px;
		}

		.chart-tooltip {
			position: absolute;
			display: none;
			padding: 5px;
			max-width: 200px;
			font-size: 12px;
			text-align: center;
			color: #fff;
			background-color: #000;
			border-radius: 4px;
			opacity: 0.8;
		}

		.chart {
			width: 100%;
			height: 400px;
		}
	</style>
	<!-- Bootstrap 3.3.6 -->
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="dist/css/min.css">

	<link rel="stylesheet" href="dist/css/skins/_all-skins.css">
	<link rel="stylesheet" href="plugins/datepicker/datepicker3.css">
	<link rel="stylesheet" type="text/css" href="plugins/datepicker/daterangepicker.css" />

	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/ionicons.min.css">
	<link rel="stylesheet" href="css/handsontable.full.css">
	<link href="css/bootstrap-datetimepicker.min.css" rel="stylesheet" media="screen">
   <link rel="stylesheet" href="js/themes/default/style.min.css">

	<script src="plugins/jQuery/jquery-2.2.3.min.js"></script>
    <script src="js/jstree.min.js"></script>
	<script src="js/chart.js"></script>
	<script src="plugins/datepicker/bootstrap-datepicker.js"></script>
	<script src="plugins/datepicker/locales/bootstrap-datepicker.zh-CN.js"></script>
	<script type="text/javascript" src="plugins/datepicker/moment.js"></script>

	<script type="text/javascript" src="plugins/datepicker/daterangepicker.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="dist/js/app.js"></script>

	<script type="text/javascript" src="js/bootstrap-datetimepicker.js" charset="UTF-8"></script>

	<script src="js/handsontable.full.js"></script>
     <script src="setup.js"></script>
	<script src="js/DDoc.js"></script>
	<script src="js/FileSaver.js"></script>
	<script src="js/jszip.js"></script>


	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>

<script type="text/javascript">
$(function(){
	$(".format-img img").wrapAll("<ul></ul>");
	$(".format-img img").each(function(){
		$(this).wrap('<li></li>');
	});
        $(".format-img li:odd").css({background:"#fff"});
})
</script>
<style type="text/css">

body{ background:#343c48;}
.format-img{min-width:780px;}
.format-img ul{ margin:0; padding:0; list-style:none; float:left; width:100%; background:#fff; text-align:center;}
	.format-img ul li{ float:left; width:14.285%;_width:14.28%; line-height:0; padding:15px 0}
		.format-img ul li img{ border:solid 0px #f08; padding:0px; background:#fff;}
</style>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>

<body class="skin-blue layout-top-nav" style="height: auto;">


	<div style="width:96.5%;margin-left :20px;box-shadow: none">
		<div class="nav-tabs-custom" style="box-shadow: none;">
			<ul class="nav nav-tabs" style="border:none">
								<p>

					<div class="pull-left">
					 
						<table border="0" cellspacing="0" cellpadding="0" width="1700"style="margin:-25px 0 0 200px;">
							<tr>
								<td width="100"; height="100">



								</td>
								 <td style="width:500px;">
								  <label style="font-size:16px;" >选择名称：</label>
								        <select id="ttp"  style="width:360px;height:40px;font-size:18px;padding:0px 10px 0px 10px;background: #343c48;">
										        <option value=-1>所有站</option>
												
										</select>  
							   </td>
							   <td> 
							   <label style="font-size:16px;margin:0 0 0 6px" align=center >选择日期：&nbsp;&nbsp;从</label>
							   </td>
									<td style="width:110px;height:40px;">
									 
								<input id="dayInput" placeholder="开始日期" class="form-control layer-date" style="width:160px;height:40px;margin-left:-164px;font-size:16px;" onclick="laydate({istime: false, format: 'YYYY-MM-DD'})">
							   <td>
							   <label style="font-size:16px;margin:0 -20px 0 -100px" >00:00</label>
							   </td>
							   </td>
							    <td> 
							   <label style="font-size:16px;margin:0 -65px 0 -36px" align=center >到</label>
							   </td>
								<td style="width:300px;padding-left:200px">
								
								&nbsp;&nbsp;<input  id="dayInput2" placeholder="结束日期" class="form-control layer-date" style="width:160px;height:40px;margin-left:-208px;font-size:16px;" onclick="laydate({istime: false, format: 'YYYY-MM-DD'})">
							   
							  
							  
							    
							    <td>
							   <label style="font-size:16px;margin:0 0 0 -125px" >23:59</label>
							   </td>
								 <td>       
								 <select id="ord"  style="width:70px;height:40px;font-size:16px;padding-left:10px;margin:0 47px 0 -48px;background: #343c48;">
										        <option value=0>时间</option>
										        <option value=1>名称</option>
										       
												
										</select>&nbsp;&nbsp;
										<label style="font-size:16px;margin:0 0 0 -50px" >排序 </label> 
							   </td>
								<td><button id="searchBtn" type="button" class="btn btn-block btn-default " style="width:100px;text-align:center;margin:8px 0px 0 0;" align="center">查询</button></td>
								<!-- <td><button id="creatDocBtn" type="button" class="btn btn-block btn-default " style="width:100px;text-align:center ; margin:8px 195px 0 -88px;" align="center" >导出</button> --></td>
								

							</tr>
						</table>

					</div>


			</ul>
			<div id="zjTitle" style="background: #2a3039;height: 65px;width: 100%;margin: 50px 0 0 20px ;padding:15px 20px"></div>
			<div id="showResult" style="position:absolute; left:600px; top:200px;width:180px;height:200px">
	                  <img src='load.gif' />
	                </div>
			<div id="editCell" class="hot handsontable" style="width:100%;margin: 0px 20px ;font-size:16px;">
			
			</div>



		</div>




		



	</div>
	

	<script type="text/javascript">
		
		var nowJz = "all"
		var nowJzLong = "all"
		var nowPlanSn = 0
		var nowZhName = ""
		var timeOutNum = 100000;
		var titleFontSize = 5;
		var columns1 = [{ data: 0, readOnly: true, type: 'text', wordWrap: false },{data: 1, readOnly: true, type: 'text'},{data: 2, readOnly: true, type: 'text'},{data: 3, readOnly: true, type: 'text'},{data: 4, readOnly: true, type: 'text'},{data: 5, readOnly: true, type: 'text'}];
		var colHeaders1 = ['序号', '时间', '站名', '设备名', '事件', '备注'];
		
		var nowTab = 1;
		var nowSearch = 0;
		var nowMode = 1;
		var tempMode = 1;
		var timeSearchTemp = "";
        
        var now = new Date(); 
		//alert(now.getDate()+'-'+now.getMonth());  
		//格式化日，如果小于9，前面补0  
		var day = ("0" + now.getDate()).slice(-2);  
		//格式化月，如果小于9，前面补0  
		var month = ("0" + (now.getMonth() + 1)).slice(-2);  
		//拼装完整日期格式  
		var today = now.getFullYear()+"-"+(month)+"-"+(day);  
		//完成赋值  
		$('#dayInput2').val(today); 
       // document.getElementById('dayInput').valueAsDate = new Date();
       now = new Date();  
       now.setTime(now.getTime()-24*60*60*1000);
       
		//alert(now.getDate()+'-'+now.getMonth());  
		//格式化日，如果小于9，前面补0  
		 day = ("0" + now.getDate()).slice(-2);  
		//格式化月，如果小于9，前面补0  
		 month = ("0" + (now.getMonth() + 1)).slice(-2);  
		//拼装完整日期格式  
		 today = now.getFullYear()+"-"+(month)+"-"+(day) ;  
		//完成赋值  
		$('#dayInput').val(today); 
       
       function gotourl(a){
        window.location=urlArr[a];
        }
       
       
        function addsel(){  
              
         
            
            
            $.ajax({  
                url:  httpIp + 'loadrtuno',
                dataType : "json",  
                type : "POST", 
                data: {pno:prono},
                success : function(data) {  
                    if(data) {
                      
                        console.info(data);  
                       $.each(data, function (i, item) {  
                                var obj = {text:item}; 
                                // console.info(item);  
                                $("#ttp").append("<option value="+data[i].value+">"+data[i].name+"</option>"); 
                       });  
                       
                    }else{  
                       console.log('ddddssdd');  
                    }  
                }  
            });  
        }   
        addsel();
         function negativeValueRenderer(instance, td, row, col, prop, value, cellProperties) {
             Handsontable.renderers.TextRenderer.apply(this, arguments);
                  if (row%2==1) 
                	  {
                	  td.style.backgroundColor = '#343c48'; 
                	  //td.style.color = '#3C3C3C';
                	  }
                	   if (col==4 && value.indexOf('恢复')>=0) 
                	  {
                	  //td.style.backgroundColor = '#F4F4F4'; 
                	  td.style.color = color_arr[4];
                	  }
                	   if (col==4 && value.indexOf('告警')>=0) 
                	  {
                	  //td.style.backgroundColor = '#F4F4F4'; 
                	  td.style.color =  color_arr[2];
                	  }
			 if (col==4 && value.indexOf('运行')>=0)
			 {
				 //td.style.backgroundColor = '#F4F4F4';
				 td.style.color =  color_arr[0];
			 }
			 if (col==4 && value.indexOf('开机')>=0)
			 {
				 //td.style.backgroundColor = '#F4F4F4';
				 td.style.color =  color_arr[0];
			 }
			 if (col==4 && value.indexOf('关机')>=0)
			 {
				 //td.style.backgroundColor = '#F4F4F4';
				 td.style.color =  color_arr[2];
			 }
			 if (col==4 && value.indexOf('越')>=0)
			 {
				 //td.style.backgroundColor = '#F4F4F4';
				 td.style.color =  color_arr[1];
			 }
                   return td;
               }
          
         Handsontable.renderers.registerRenderer('negativeValueRenderer', negativeValueRenderer);
		
		editHot = new Handsontable(document.getElementById('editCell'),
			{
				columns: columns1,
				data: [],
				formulas: true,
				outsideClickDeselects: false,
				stretchH: 'all',
				colHeaders: colHeaders1,
				rowHeaders: false,
				fillHandle: false,
				colWidths: [30,100,70,100,60,70],
				contextMenu: false,
				disableVisualSelection: false,
				className: 'htCenter',
				enterBeginsEditing: false,
				multiSelect: true,
				beforeOnCellMouseDown: function (event, coords) {
					if (coords.row < 0) {
						event.stopImmediatePropagation();
					}
				},
					 cells: function (row, col, prop) {
		                   var cellProperties = {};
		                   cellProperties.renderer = "negativeValueRenderer";
		                   return cellProperties;
		                   }
			});
			
			
			function beforeSend(XMLHttpRequest){    
		    //console.log("ddd");
 			 $("#showResult").show();    
			}    
		function complete(XMLHttpRequest, textStatus){    
  		$("#showResult").hide();    
			}  
			
		function loadPlan() {
			var dstr =$('#dayInput').val();
			var dstr2 =$('#dayInput2').val();
			var ttp  =$('#ttp').val();
			var ord  =$('#ord').val();
			console.log(ttp);
			$.ajax({
				url: httpIp + 'getTfPlanAll_evt',
				type: 'POST',
				async: true, 
				data: { crew: dstr, tab: dstr2, pId: ttp,ob:ord,pno:prono ,userId:uid},
				timeout: timeOutNum,
				dataType: 'json',
				 beforeSend:beforeSend, //发送请求        
                 complete:complete,//请求完成    
				success: function (data, textStatus, jqXHR) {
					if (data.result == 1) {
					    $("#zjTitle").html("<font size='" + titleFontSize + "'>" +  "  事件列表" + "</font>");
					    console.log(data);
					    editData = [];
						editData = JSON.parse(JSON.stringify(data.data));
						
						editHot.loadData(editData)

					}
				},
				error: function (xhr, textStatus) {
					editHot.loadData([]);
				}
			})	
		}	
		function loadTfPlan(jz,mode, sn) {
			
			//dcPlanName = nowZhName + "" + nowPlanName;
           // console.log(jz+"___"+mode+"___"+sn);
			// $.ajax({
			// 	url: httpIp + '/getTfData',
			// 	type: 'POST',
			// 	async: true,
			// 	data: { crew: jz, crewLong: mode, pId: sn },
			// 	timeout: timeOutNum,
			// 	dataType: 'json',
			// 	success: function (data, textStatus, jqXHR) {
			// 		if (data.result == 1) {
			// 		    //console.log(data);
			// 			$("#zjTitle").html("<font size='" + titleFontSize + "'>" + data.planJson.jzName + "  历史曲线" + "</font>");
						
			// 			tfzjToolTip = data.tooltipArr
			// 			var info = ""
			// 			planInfo = data.planJson.infoArr;
			// 			for (var i = 0; i < data.planJson.infoArr.length; i++) {
			// 				info += data.planJson.infoArr[i] + "<br>"
			// 			}
			// 			destroyChart("");
			// 			//Chart.defaults.global.pointHitDetectionRadius=1
			// 			zjChart = new Chart(ctx2, {
			// 				type: 'line',
			// 				data:
			// 				{
			// 					labels: data.planJson.labels,
			// 					datasets:
			// 					[
			// 						{
			// 							label: "当日",
			// 							fill: false,
			// 							lineTension: 0,
			// 							backgroundColor: "rgba(255, 99, 132, 0.3)",
			// 							borderColor: "rgba(255, 99, 132, 1)",
			// 							borderCapStyle: 'butt',
			// 							borderDash: [],
			// 							borderDashOffset: 0.0,
			// 							borderJoinStyle: 'miter',
			// 							pointBorderColor: "rgba(255, 99, 132, 1)",
			// 							pointBackgroundColor: "#fff",
			// 							pointBorderWidth: 1,
			// 							pointHoverRadius: 5,
			// 							pointHoverBackgroundColor: "rgba(255, 99, 132, 1)",
			// 							pointHoverBorderColor: "rgba(220,220,220,1)",
			// 							pointHoverBorderWidth: 2,
			// 							pointRadius: 1,
			// 							pointHitRadius: 10,
			// 							data: data.data,
			// 							spanGaps: true
			// 						},
			// 						{
			// 							label: "昨日",
			// 							fill: false,
			// 							lineTension: 0,
			// 							backgroundColor: "rgba(75,192,192,0.4)",
			// 							borderColor: "rgba(75,192,192,1)",
			// 							borderCapStyle: 'butt',
			// 							borderDash: [],
			// 							borderDashOffset: 0.0,
			// 							borderJoinStyle: 'miter',
			// 							pointBorderColor: "rgba(75,192,192,1)",
			// 							pointBackgroundColor: "#fff",
			// 							pointBorderWidth: 1,
			// 							pointHoverRadius: 5,
			// 							pointHoverBackgroundColor: "rgba(75,192,192,1)",
			// 							pointHoverBorderColor: "rgba(220,220,220,1)",
			// 							pointHoverBorderWidth: 2,
			// 							pointRadius: 1,
			// 							pointHitRadius: 10,
			// 							data: data.planJson.data,
			// 							spanGaps: true
			// 						}
			// 					]
			// 				},
			// 				options:
			// 				{
			// 					scales:
			// 					{
			// 						xAxes: [{
			// 							ticks: {
			// 								autoSkip: true
			// 							}
			// 						}],
			// 						yAxes: [{
			// 							ticks: {
			// 							    autoSkip: true,
			// 								beginAtZero: true
			// 							}
			// 						}],
			// 					},
			// 					tooltips:
			// 					{
			// 						callbacks:
			// 						{
			// 							label: function (tooltipItem, data) {
			// 								return tfzjToolTip[tooltipItem.index]
			// 							}
			// 						}
			// 					}
			// 				}
			// 			});

			// 			tfPlanToolTip = data.planJson.tooltipArr;
			// 			//$("#jhInfo").html(info); 
			// 			planChart = new Chart(ctx1, {
			// 				type: 'line',
			// 				data:
			// 				{
			// 					labels: data.planJson.labels,
			// 					datasets:
			// 					[
			// 						{
			// 							label: "计划",
			// 							fill: false,
			// 							lineTension: 0,
			// 							backgroundColor: "rgba(75,192,192,0.4)",
			// 							borderColor: "rgba(75,192,192,1)",
			// 							borderCapStyle: 'butt',
			// 							borderDash: [],
			// 							borderDashOffset: 0.0,
			// 							borderJoinStyle: 'miter',
			// 							pointBorderColor: "rgba(75,192,192,1)",
			// 							pointBackgroundColor: "#fff",
			// 							pointBorderWidth: 1,
			// 							pointHoverRadius: 5,
			// 							pointHoverBackgroundColor: "rgba(75,192,192,1)",
			// 							pointHoverBorderColor: "rgba(220,220,220,1)",
			// 							pointHoverBorderWidth: 2,
			// 							pointRadius: 1,
			// 							pointHitRadius: 10,
			// 							data: data.planJson.data,
			// 							spanGaps: true
			// 						}
			// 					]
			// 				},

			// 				options:
			// 				{
			// 					scales:
			// 					{
			// 						xAxes: [{
			// 							ticks: {
			// 								autoSkip: true

			// 							}
			// 						}],
			// 						yAxes: [{
			// 							ticks: {
			// 								beginAtZero: true
			// 							}
			// 						}],
			// 					},
			// 					tooltips:
			// 					{
			// 						callbacks:
			// 						{
			// 							label: function (tooltipItem, data) {
			// 								return tfPlanToolTip[tooltipItem.index]
			// 							}
			// 						}
			// 					}
			// 				}
			// 			});

			// 		}
			// 		else {
			// 			destroyChart("无匹配数据")
			// 		}
			// 	},
			// 	error: function (xhr, textStatus) {
			// 		destroyChart("加载失败")
			// 	}
			// })
			$("#tab_1").show();
			$("#tab_2").hide();
		}
			$("#searchBtn").click(function () {
			var dstr =$('#dayInput').val();
            loadPlan(); 
		})
		 loadPlan(); 
		 
		 
		 
		 
	</script>
	
	
	  <script src="js/content.min.js?v=1.0.0"></script>
    <script src="js/plugins/layer/laydate/laydate.js"></script>
     <script>
        laydate({elem:"#dayInput",event:"focus"});var start={elem:"#start",format:"YYYY/MM/DD hh:mm:ss",min:laydate.now(),max:"2099-06-16 23:59:59",istime:true,istoday:false,choose:function(datas){end.min=datas;end.start=datas}};var end={elem:"#end",format:"YYYY/MM/DD hh:mm:ss",min:laydate.now(),max:"2099-06-16 23:59:59",istime:true,istoday:false,choose:function(datas){start.max=datas}};laydate(start);laydate(end);
    </script>

</body>

</html>